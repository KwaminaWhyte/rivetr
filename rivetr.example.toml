# Rivetr Configuration Example
# Copy this file to rivetr.toml and customize

[server]
host = "0.0.0.0"
api_port = 8080
proxy_port = 80
proxy_https_port = 443
data_dir = "./data"

[auth]
# API token for programmatic access (generate a secure token for production!)
admin_token = "change-me-in-production"

[runtime]
# Options: "auto", "docker", "podman"
runtime_type = "auto"
# Docker socket path (Linux default shown)
docker_socket = "/var/run/docker.sock"

[proxy]
# Enable automatic HTTPS with Let's Encrypt
acme_enabled = false
# Email for Let's Encrypt account registration (required if acme_enabled = true)
# acme_email = "admin@example.com"
# Use Let's Encrypt staging environment for testing (avoids rate limits)
acme_staging = true
# Directory to store ACME account and certificates
acme_cache_dir = "./data/acme"
# Health check settings
health_check_interval = 30
health_check_timeout = 5
health_check_threshold = 3
# Base domain for auto-generated app subdomains (e.g., "rivetr.example.com")
# Apps will automatically get subdomains like "my-app.rivetr.example.com"
# base_domain = "rivetr.example.com"
# Enable automatic subdomain generation for new apps (requires base_domain)
auto_subdomain_enabled = false
# Enable sslip.io automatic domains (generates domains like abc123.192.168.1.1.sslip.io)
# This provides free wildcard DNS for any IP address without custom DNS setup
sslip_enabled = true
# Server's public IP address for sslip.io domain generation
# If not set, you'll need to configure it for sslip.io to work
# server_ip = "192.168.1.100"

[logging]
# Options: "trace", "debug", "info", "warn", "error"
level = "info"

[webhooks]
# Webhook secrets for signature verification (optional but recommended)
# GitHub: Used to verify X-Hub-Signature-256 header (HMAC-SHA256)
# github_secret = "your-github-webhook-secret"
# GitLab: Token to match X-Gitlab-Token header
# gitlab_token = "your-gitlab-webhook-token"
# Gitea: Used to verify X-Gitea-Signature header (HMAC-SHA256)
# gitea_secret = "your-gitea-webhook-secret"

[rate_limit]
# Enable rate limiting (default: true)
enabled = true
# Requests per window for general API endpoints (default: 100)
api_requests_per_window = 100
# Requests per window for webhook endpoints (default: 500)
webhook_requests_per_window = 500
# Requests per window for auth endpoints - stricter to prevent brute force (default: 20)
auth_requests_per_window = 20
# Window duration in seconds (default: 60)
window_seconds = 60
# Cleanup interval for expired rate limit entries in seconds (default: 300)
cleanup_interval = 300

[cleanup]
# Enable automatic cleanup of old deployments (default: true)
enabled = true
# Maximum number of deployments to keep per app (default: 10)
# Older deployments will be removed, along with their containers and images
max_deployments_per_app = 10
# Interval between cleanup runs in seconds (default: 3600 = 1 hour)
cleanup_interval_seconds = 3600
# Prune unused/dangling Docker/Podman images after cleanup (default: true)
# This helps reclaim disk space from orphaned image layers
prune_images = true
